'\" te
.\" Copyright (C) 2005, Sun Microsystems, Inc. All Rights Reserved
.\" Copyright 1989 AT&T
.\" CDDL HEADER START
.\"
.\" The contents of this file are subject to the terms of the
.\" Common Development and Distribution License (the "License").
.\" You may not use this file except in compliance with the License.
.\"
.\" You can obtain a copy of the license at usr/src/OPENSOLARIS.LICENSE
.\" or http://www.opensolaris.org/os/licensing.
.\" See the License for the specific language governing permissions
.\" and limitations under the License.
.\"
.\" When distributing Covered Code, include this CDDL HEADER in each
.\" file and include the License file at usr/src/OPENSOLARIS.LICENSE.
.\" If applicable, add the following below this CDDL HEADER, with the
.\" fields enclosed by brackets "[]" replaced with your own identifying
.\" information: Portions Copyright [yyyy] [name of copyright owner]
.\"
.\" CDDL HEADER END
.TH chkey 1 "29 Nov 2005" "SunOS 5.11" "User Commands"
.SH NAME
chkey \- change user's secure RPC key pair
.SH SYNOPSIS
.LP
.nf
\fBchkey\fR [\fB-p\fR] [\fB-s\fR nisplus | nis | files | ldap]
     [\fB-m\fR \fI<mechanism>\fR]
.fi

.SH DESCRIPTION
.sp
.LP
\fBchkey\fR is used to change a user's secure \fBRPC\fR public key and secret
key pair.
.B chkey
prompts for the old secure-rpc password and verifies that
it is correct by decrypting the secret key. If the user has not already used
.BR keylogin (1)
to decrypt and store the secret key with
.BR keyserv (1M),
\fBchkey\fR registers the secret key with the local \fBkeyserv\fR(1M) daemon. If
the secure-rpc password does not match the login password,
.B chkey
prompts
for the login password.
.B chkey
uses the login password to encrypt the user's
secret Diffie-Hellman (192 bit) cryptographic key.
.B chkey
can also encrypt
other Diffie-Hellman keys for authentication mechanisms configured using
.BR nisauthconf (1M).
.sp
.LP
\fBchkey\fR ensures that the login password and the secure-rpc password(s) are
kept the same, thus enabling password shadowing. See
.BR shadow (4).
.sp
.LP
The key pair can be stored in the
.B /etc/publickey
file (see
.BR publickey (4)),
the
.B "NIS publickey"
.RB "map, or the" " NIS+"
\fBcred.org_dir\fR table. If a new secret key is generated, it will be registered
with the local
.BR keyserv "(1M) daemon. However, only"
.B NIS+
can store
Diffie-Hellman keys other than 192-bits.
.sp
.LP
Keys for specific mechanisms can be changed or reencrypted using the
.BR -m
option followed by the authentication mechanism name. Multiple
.B -m
options
can be used to change one or more keys. However, only mechanisms configured using
\fBnisauthconf\fR(1M) can be changed with  \fBchkey\fR.
.sp
.LP
If the source of the
.B publickey
is not specified with the
.B -s
option,
\fBchkey\fR consults the  \fBpublickey\fR entry in the name service switch
configuration file.  See
.BR nsswitch.conf (4).
If the
.B publickey
entry
specifies one and only one source, then
.B chkey
will change the key in the
specified name service. However, if multiple name services are listed,
\fBchkey\fR can not decide which source to update and will display an error
message. The user should specify the source explicitly with the \fB-s\fR
option.
.sp
.LP
Non root users are not allowed to change their key pair in the \fBfiles\fR
database.
.SH OPTIONS
.sp
.LP
The following options are supported:
.sp
.ne 2
.mk
.na
.B -p
.ad
.RS 18n
.rt
Re-encrypt the existing secret key with the user's login password.
.RE

.sp
.ne 2
.mk
.na
.B -s nisplus
.ad
.RS 18n
.rt
Update the
.B NIS+
database.
.RE

.sp
.ne 2
.mk
.na
.B -s nis
.ad
.RS 18n
.rt
Update the
.B NIS
database.
.RE

.sp
.ne 2
.mk
.na
\fB-s files\fR
.ad
.RS 18n
.rt
Update the  \fBfiles\fR database.
.RE

.sp
.ne 2
.mk
.na
.B -s ldap
.ad
.RS 18n
.rt
Update the  LDAP database.
.RE

.sp
.ne 2
.mk
.na
.BI -m " <mechanism>"
.ad
.RS 18n
.rt
Changes or re-encrypt the secret key for the specified mechanism.
.RE

.SH FILES
.sp
.ne 2
.mk
.na
\fB/etc/nsswitch.conf\fR
.ad
.RS 22n
.rt

.RE

.sp
.ne 2
.mk
.na
.B /etc/publickey
.ad
.RS 22n
.rt

.RE

.SH ATTRIBUTES
.sp
.LP
See
.BR attributes (5)
for descriptions of the following attributes:
.sp

.sp
.TS
tab() box;
cw(2.75i) |cw(2.75i)
lw(2.75i) |lw(2.75i)
.
ATTRIBUTE TYPEATTRIBUTE VALUE
_
AvailabilitySUNWcsu
.TE

.SH SEE ALSO
.sp
.LP
.BR keylogin (1),
.BR keylogout (1),
.BR keyserv (1M),
.BR newkey (1M),
.BR nisaddcred (1M),
\fBnisauthconf\fR(1M), \fBnsswitch.conf\fR(4),
.BR publickey (4),
.BR shadow (4),
.BR attributes (5)
.SH NOTES
.sp
.LP
NIS+ might not be supported in future releases of the Solaris operating system.
Tools to aid the migration from NIS+ to LDAP are available in the current Solaris
release. For more information, visit
http://www.sun.com/directory/nisplus/transition.html.
