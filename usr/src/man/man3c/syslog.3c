'\" te
.\" Copyright (c) 2009, Sun Microsystems, Inc.  All Rights Reserved.
.\" Copyright (c) 2012-2013, J. Schilling
.\" Copyright (c) 2013, Andreas Roehler
.\" Copyright (c) 1983 Regents of the University of California.
.\" All rights reserved. The Berkeley software License Agreement
.\" specifies the terms and conditions for redistribution.
.\" Portions Copyright (c) 1992, X/Open Company Limited  All Rights Reserved
.\"
.\" Sun Microsystems, Inc. gratefully acknowledges The Open Group for
.\" permission to reproduce portions of its copyrighted documentation.
.\" Original documentation from The Open Group can be obtained online
.\" at http://www.opengroup.org/bookstore/.
.\"
.\" The Institute of Electrical and Electronics Engineers and The Open Group,
.\" have given us permission to reprint portions of their documentation.
.\"
.\" In the following statement, the phrase "this text" refers to portions
.\" of the system documentation.
.\"
.\" Portions of this text are reprinted and reproduced in electronic form in
.\" the Sun OS Reference Manual, from IEEE Std 1003.1, 2004 Edition, Standard
.\" for Information Technology -- Portable Operating System Interface (POSIX),
.\" The Open Group Base Specifications Issue 6, Copyright (C) 2001-2004 by the
.\" Institute of Electrical and Electronics Engineers, Inc and The Open Group.
.\" In the event of any discrepancy between these versions and the original
.\" IEEE and The Open Group Standard, the original IEEE and The Open Group
.\" Standard is the referee document.
.\"
.\" The original Standard can be obtained online at
.\" http://www.opengroup.org/unix/online.html.
.\"
.\" This notice shall appear on any product containing this material.
.\"
.TH syslog 3C "16 Mar 2009" "SunOS 5.11" "Standard C Library Functions"
.SH NAME
syslog, openlog, closelog, setlogmask \- control system log
.SH SYNOPSIS
.LP
.nf
#include <syslog.h>

\fBvoid\fR \fBopenlog\fR(\fBconst char *\fIident\fR, \fBint\fR \fIlogopt\fR, \fBint\fR \fIfacility\fR);
.fi

.LP
.nf
\fBvoid\fR \fBsyslog\fR(\fBint\fR \fIpriority\fR, \fBconst char *\fImessage\fR, \fB\&.\|.\|./*\fR \fIarguments\fR */);
.fi

.LP
.nf
\fBvoid\fR \fBcloselog\fR(\fBvoid\fR);
.fi

.LP
.nf
\fBint\fR \fBsetlogmask\fR(\fBint\fR \fImaskpri\fR);
.fi

.SH DESCRIPTION
.sp
.LP
The
.B syslog()
function sends a message to
.BR syslogd "(1M), which,"
depending on the configuration of
.BR /etc/syslog.conf ,
logs it in an
appropriate system log, writes it to the system console, forwards it to a
list of users, or forwards it to
.B syslogd
on another host over the
network. The logged message includes a message header and a message body.
The message header consists of a facility indicator, a severity level
indicator, a timestamp, a tag string, and optionally the process ID.
.sp
.LP
The message body is generated from the
.I message
and following
arguments in the same manner as if these were arguments to
.BR printf (3UCB),
except that occurrences of
.B %m
in the format string
pointed to by the
.I message
argument are replaced by the error message
string associated with the current value of
.BR errno .
A trailing
.B NEWLINE
character is added if needed.
.sp
.LP
Symbolic constants for use as values of the
.IR logopt ,
.IR facility ,
.IR priority ,
and
.I maskpri
arguments are defined in the
.RB < syslog.h >
header.
.sp
.LP
Values of the
.I priority
argument are formed by ORing together a
.I severity level
value and an optional
.I facility
value.  If no
facility value is specified, the current default facility value is used.
.sp
.LP
Possible values of severity level include, in decreasing order:
.sp
.ne 2
.mk
.na
.B LOG_EMERG
.ad
.RS 15n
.rt
A panic condition.  This is normally broadcast to all users.
.RE

.sp
.ne 2
.mk
.na
.B LOG_ALERT
.ad
.RS 15n
.rt
A condition that should be corrected immediately, such as a corrupted
system database.
.RE

.sp
.ne 2
.mk
.na
.B LOG_CRIT
.ad
.RS 15n
.rt
Critical conditions, such as hard device errors.
.RE

.sp
.ne 2
.mk
.na
.B LOG_ERR
.ad
.RS 15n
.rt
Errors.
.RE

.sp
.ne 2
.mk
.na
.B LOG_WARNING
.ad
.RS 15n
.rt
Warning messages.
.RE

.sp
.ne 2
.mk
.na
.B LOG_NOTICE
.ad
.RS 15n
.rt
Conditions that are not error conditions, but that may require special
handling.
.RE

.sp
.ne 2
.mk
.na
.B LOG_INFO
.ad
.RS 15n
.rt
Informational messages.
.RE

.sp
.ne 2
.mk
.na
.B LOG_DEBUG
.ad
.RS 15n
.rt
Messages that contain information normally of use only when debugging a
program.
.RE

.sp
.LP
The facility indicates the application or system component generating the
message. Possible facility values include:
.sp
.ne 2
.mk
.na
.B LOG_KERN
.ad
.RS 14n
.rt
Messages generated by the kernel. These cannot be generated by any user
processes.
.RE

.sp
.ne 2
.mk
.na
.B LOG_USER
.ad
.RS 14n
.rt
Messages generated by random user processes. This is the default facility
identifier if none is specified.
.RE

.sp
.ne 2
.mk
.na
.B LOG_MAIL
.ad
.RS 14n
.rt
The mail system.
.RE

.sp
.ne 2
.mk
.na
.B LOG_DAEMON
.ad
.RS 14n
.rt
System daemons, such as
.BR in.ftpd (1M).
.RE

.sp
.ne 2
.mk
.na
.B LOG_AUTH
.ad
.RS 14n
.rt
The authentication / security / authorization system:
.BR login (1),
.BR su (1M),
.BR getty (1M).
.RE

.sp
.ne 2
.mk
.na
.B LOG_LPR
.ad
.RS 14n
.rt
The line printer spooling system:
.BR lpr (1B),
.BR lpc (1B).
.RE

.sp
.ne 2
.mk
.na
.B LOG_NEWS
.ad
.RS 14n
.rt
Designated for the
.B USENET
network news system.
.RE

.sp
.ne 2
.mk
.na
.B LOG_UUCP
.ad
.RS 14n
.rt
Designated for the
.B UUCP
system; it does not currently use
.BR syslog() .
.RE

.sp
.ne 2
.mk
.na
.B LOG_CRON
.ad
.RS 14n
.rt
The \fBcron\fR/\fBat\fR facility;
.BR crontab (1),
\fBat\fR(1),
.BR cron (1M).
.RE

.sp
.ne 2
.mk
.na
.B LOG_AUDIT
.ad
.RS 14n
.rt
The audit facility, for example,
.BR auditd (1M).
.RE

.sp
.ne 2
.mk
.na
.B LOG_LOCAL0
.ad
.RS 14n
.rt
Designated for local use.
.RE

.sp
.ne 2
.mk
.na
.B LOG_LOCAL1
.ad
.RS 14n
.rt
Designated for local use.
.RE

.sp
.ne 2
.mk
.na
.B LOG_LOCAL2
.ad
.RS 14n
.rt
Designated for local use.
.RE

.sp
.ne 2
.mk
.na
.B LOG_LOCAL3
.ad
.RS 14n
.rt
Designated for local use.
.RE

.sp
.ne 2
.mk
.na
.B LOG_LOCAL4
.ad
.RS 14n
.rt
Designated for local use.
.RE

.sp
.ne 2
.mk
.na
.B LOG_LOCAL5
.ad
.RS 14n
.rt
Designated for local use.
.RE

.sp
.ne 2
.mk
.na
.B LOG_LOCAL6
.ad
.RS 14n
.rt
Designated for local use.
.RE

.sp
.ne 2
.mk
.na
.B LOG_LOCAL7
.ad
.RS 14n
.rt
Designated for local use.
.RE

.sp
.LP
The
.B openlog()
function sets process attributes that affect subsequent
calls to
.BR syslog() .
The
.I ident
argument is a string that is
prepended to every message. The
.B openlog()
function uses the passed-in
.I ident
argument directly, rather than making a private copy of it. The
.I logopt
argument indicates logging options.  Values for
.I logopt
are constructed by a bitwise-inclusive OR of zero or more of the
following:
.sp
.ne 2
.mk
.na
.B LOG_PID
.ad
.RS 14n
.rt
Log the process
.B ID
with each message.  This is useful for identifying
specific daemon processes (for daemons that fork).
.RE

.sp
.ne 2
.mk
.na
.B LOG_CONS
.ad
.RS 14n
.rt
Write messages to the system console if they cannot be sent to
.BR syslogd (1M).
This option is safe to use in daemon processes that have
no controlling terminal, since
.B syslog()
forks before opening the
console.
.RE

.sp
.ne 2
.mk
.na
.B LOG_NDELAY
.ad
.RS 14n
.rt
Open the connection to
.BR syslogd "(1M) immediately.  Normally the open is"
delayed until the first message is logged. This is useful for programs that
need to manage the order in which file descriptors are allocated.
.RE

.sp
.ne 2
.mk
.na
.B LOG_ODELAY
.ad
.RS 14n
.rt
Delay open until
.B syslog()
is called.
.RE

.sp
.ne 2
.mk
.na
.B LOG_NOWAIT
.ad
.RS 14n
.rt
Do not wait for child processes that have been forked to log messages onto
the console.  This option should be used by processes that enable
notification of child termination using
.BR SIGCHLD ,
since
.BR syslog()
may otherwise block waiting for a child whose exit status has already been
collected.
.RE

.sp
.LP
The
.I facility
argument encodes a default facility to be assigned to
all messages that do not have an explicit facility already encoded.  The
initial default facility is
.BR LOG_USER .
.sp
.LP
The
.B openlog()
and
.B syslog()
functions may allocate a file
descriptor. It is not necessary to call
.B openlog()
prior to calling
.BR syslog() .
.sp
.LP
The
.B closelog()
function closes any open file descriptors allocated by
previous calls to
.B openlog()
or
.BR syslog() .
.sp
.LP
The
.B setlogmask()
function sets the log priority mask for the current
process to
.I maskpri
and returns the previous mask.  If the
.I maskpri
argument is 0, the current log mask is not modified.  Calls by
the current process to
.B syslog()
with a priority not set in
.I maskpri
are rejected.  The mask for an individual priority
.I pri
is calculated by the macro \fBLOG_MASK(\fIpri\fR)\fR; the mask for all
priorities up to and including
.I toppri
is given by the macro
\fBLOG_UPTO(\fItoppri\fR)\fR. The default log mask allows all priorities to
be logged.
.SH RETURN VALUES
.sp
.LP
The
.B setlogmask()
function returns the previous log priority mask. The
.BR closelog() ,
.B openlog()
and
.B syslog()
functions return no
value.
.SH ERRORS
.sp
.LP
No errors are defined.
.SH EXAMPLES
.LP
.B Example 1
Example of
.B LOG_ALERT
message.
.sp
.LP
This call logs a message at priority
.BR LOG_ALERT :

.sp
.in +2
.nf
\fBsyslog(LOG_ALERT, "who: internal error 23")\fR;
.fi
.in -2
.sp

.sp
.LP
The
.B FTP
daemon
.B ftpd
would make this call to
.B openlog()
to
indicate that all messages it logs should have an identifying string of
.BR ftpd ,
should be treated by
.BR syslogd (1M)
as other messages from
system daemons are, should include the process
.B ID
of the process
logging the message:

.sp
.in +2
.nf
\fBopenlog("ftpd", LOG_PID, LOG_DAEMON)\fR;
.fi
.in -2
.sp

.sp
.LP
Then it would make the following call to
.B setlogmask()
to indicate
that messages at priorities from
.B LOG_EMERG
through
.BR LOG_ERR
should be logged, but that no messages at any other priority should be
logged:

.sp
.in +2
.nf
\fBsetlogmask(LOG_UPTO(LOG_ERR))\fR;
.fi
.in -2
.sp

.sp
.LP
Then, to log a message at priority
.BR LOG_INFO ,
it would make the
following call to
.BR syslog :

.sp
.in +2
.nf
\fBsyslog(LOG_INFO, "Connection from host %d", CallingHost)\fR;
.fi
.in -2
.sp

.sp
.LP
A locally-written utility could use the following call to
.B syslog()
to
log a message at priority
.B LOG_INFO
to be treated by
.BR syslogd (1M)
as other messages to the facility
.B LOG_LOCAL2
are:

.sp
.in +2
.nf
\fBsyslog(LOG_INFO|LOG_LOCAL2, "error: %m")\fR;
.fi
.in -2
.sp

.SH ATTRIBUTES
.sp
.LP
See
.BR attributes (5)
for descriptions of the following attributes:
.sp

.sp
.TS
tab() box;
cw(2.75i) |cw(2.75i)
lw(2.75i) |lw(2.75i)
.
ATTRIBUTE TYPEATTRIBUTE VALUE
_
Interface StabilityCommitted
_
MT-LevelSafe
_
StandardSee \fBstandards\fR(5).
.TE

.SH SEE ALSO
.sp
.LP
.BR at (1),
.BR crontab (1),
.BR logger (1),
.BR login (1),
.BR lpc (1B),
.BR lpr (1B),
.BR auditd (1M),
.BR cron (1M),
.BR getty (1M),
.BR in.ftpd (1M),
.BR su (1M),
.BR syslogd (1M),
.BR printf (3UCB),
.BR syslog.conf (4),
.BR attributes (5),
.BR standards (5)
